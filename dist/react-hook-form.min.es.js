import e,{useState as t,useEffect as a,Fragment as l}from"react";import{useFormContext as n,Controller as r,useForm as o,FormContext as s}from"react-hook-form";import{Checkbox as i,DatePicker as c,Input as u,InputNumber as d,Radio as m,Select as h,Button as p,Table as b}from"antd";import g from"moment";import f from"classnames";import{Resizable as y}from"react-resizable";var v=Object.freeze({__proto__:null,get onRenderHooks(){return T},get BaseForm(){return _},get CheckBox(){return C},get DatePicker(){return z},get DateTimePicker(){return D},get Form(){return M},get Input(){return N},get InputNumber(){return P},get Radio(){return F},get Select(){return R}});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function w(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(l=Object.getOwnPropertySymbols(e);n<l.length;n++)t.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(a[l[n]]=e[l[n]])}return a}var E=".error {\n  width: auto;\n  min-height: 16px;\n  line-height: 18px;\n  color: #f5222d;\n  word-break: break-all;\n  word-wrap: break-word;\n}\n";const _=t=>{const{errors:a,control:l}=n(),{rules:o,label:s,value:i,input_type:c,name:u="",className:d="",disabled:m=!1,show_required:h=!0,extend_text:p="",is_required:b=2}=t,g=w(t,["rules","label","value","input_type","name","className","disabled","show_required","extend_text","is_required"]),f=Object.assign(Object.assign({},g),{value:i,defaultValue:i,disabled:m}),y=v[c];return y?e.createElement("div",{className:"hooks-row hooks-form-item",key:u||(new Date).getTime()},!!s&&e.createElement("div",{className:"hooks-col hooks-form-item-label"},e.createElement("label",{htmlFor:u},h&&((null==o?void 0:o.required)||1===b)&&e.createElement("span",{className:E.required},"*"),s)),e.createElement("div",{className:"hooks-col hooks-form-item-wrapper"},e.createElement(r,{as:e.createElement(y,Object.assign({},f)),defaultValue:i,control:l,rules:o,name:u}),e.createElement("div",{className:E.error}," ",a[u]&&a[u].message))):(console.log(`${c} 当前组件不支持`),null)},k=(e,t)=>{if(t())e();else var a=0,l=setInterval((function(){++a>500?clearInterval(l):t()&&(e(),clearInterval(l))}),30)},O=function(e,t){return new Promise((function(a){t?setTimeout((function(){a(e)}),t||1):a(e)}))},j=(e,t)=>{for(var a=/(?:(?:^|\.)([^\.\[\]]+))|(?:\[([^\[\]]+)\])/g,l=[],n=null;null!=(n=a.exec(t));)l.push(n[1]||n[2]);for(var r=e,o=0;o<l.length;o++)if(void 0===(r=null==r?void 0:r[l[o]]))return;return r},Y=e=>e&&e instanceof Array&&!!e.length,$=e=>e&&e instanceof Object&&!(e instanceof Array)&&!!Object.keys(e).length;var x=Object.freeze({__proto__:null,isArray:Y,isObject:$,bsWait:function(e){return O(null,e)},bsPromise:O,bsCheck:e=>new Promise((function(t){k(t,e)})),bsRunWhen:k,setValueByPath:(e,t,a)=>{for(var l=/(?:(?:^|\.)([^\.\[\]]+))|(?:\[([^\[\]]+)\])/g,n=[],r=null;null!=(r=l.exec(t));)n.push(r[1]||r[2]);if(0===n.length)return e;return function e(t){const l=n[0];t[n[0]]=1===n.length?a:t[n[0]]||{},n.shift(),n.length&&e(t[l])}(e),e},getValueByPath:j});const{Group:S}=i,C=l=>{const{name:n,style:r,value:o,options:s,disabled:c,mode:u="default",show_all:d=!1,value_key:m="id",show_empty:h=!1,label_key:p="name",placeholder:b="请选择"}=l,g=w(l,["name","style","value","options","disabled","mode","show_all","value_key","show_empty","label_key","placeholder"]),[f,y]=t([]);a(()=>{Y(s)&&y(s)},[p,s,d,m]);const v={mode:u,value:o,defaultValue:o,disabled:!!c,style:Object.assign({width:"100%"},r)};return Y(f)?e.createElement(S,Object.assign({},v,g),f.map((t,a)=>e.createElement(i,Object.assign({},t,{value:`${t[m]}`,label:t[p],disabled:!!c||!!t.disabled,key:`${t[m]}-${a}`}),t[p])),h&&(()=>{if("default"===u){return!f.find(e=>e.id===o)&&e.createElement(i,{value:o},"==",o,"==无对应选项==")}if("multiple"===u){let t=[];return null==o||o.forEach(e=>{!f.find(t=>t[m]===e)&&t.push(e)}),e.createElement(e.Fragment,null,null==t?void 0:t.map(t=>e.createElement(i,{value:t},"==",t,"==无对应选项==")))}return null})()):e.createElement(S,Object.assign({},v,g))},V={year:"YYYY",month:"YYYY-MM",date:"YYYY-MM-DD",time:"YYYY-MM-DD HH:mm:ss"},z=a=>{const{placeholder:l="请选择",mode:n="date",onChange:r}=a,o=w(a,["placeholder","mode","onChange"]),{value:s,defaultValue:i}=o,[u,d]=t(s||i||void 0),m=e=>{e="month"===n?{start_time:e?`${e.format(V[n]||"YYYY-MM-DD")}-01`:void 0,end_time:e?`${e.format(V[n]||"YYYY-MM-DD")}-${e.daysInMonth()}`:void 0}:e?e.format(V[n]||"YYYY-MM-DD"):void 0,d(e),r&&r(e)},h=u?g(new Date($(s)?s.start_time:s)):void 0,p=Object.assign(Object.assign({allowClear:!1,placeholder:l,style:{width:"100%"},showTime:"time"===n},o),{value:h,onChange:m,onPanelChange:m,format:V[n]||"YYYY-MM-DD"});return e.createElement(c,Object.assign({},p))},D=t=>e.createElement(z,Object.assign({},t,{mode:"time"})),M=t=>{const{data:a,children:l,defaultValues:n,layout:r="inline",labelAlign:o="right",hideRequiredMark:s=!1}=t,i=`hooks-form hooks-form-${r} label-${o} ${s?"hide_require":""}`;return e.createElement("form",{className:i},l||e.createElement(e.Fragment,null,a.map(e=>T(e,n))))},N=t=>{const{value:a,placeholder:l="请输入",style:n}=t,r=w(t,["value","placeholder","style"]);return e.createElement(u,Object.assign({key:`${t.id}-input`,autoComplete:"off"},r,{defaultValue:a,placeholder:l,style:n}))},P=t=>{const{placeholder:a="请输入"}=t,l=w(t,["placeholder"]);return e.createElement(d,Object.assign({},l,{placeholder:a}))},{Group:q}=m,F=l=>{const{name:n,style:r,value:o,options:s,disabled:i,mode:c="default",value_key:u="id",show_empty:d=!1,label_key:h="name"}=l,p=w(l,["name","style","value","options","disabled","mode","value_key","show_empty","label_key"]),[b,g]=t([]);a(()=>{Y(s)&&g(s)},[h,s,u]);const f={mode:c,value:o,defaultValue:o,disabled:!!i,style:Object.assign({width:"100%"},r)};return Y(b)?e.createElement(q,Object.assign({},f,p),b.map((t,a)=>e.createElement(m,Object.assign({},t,{value:`${t[u]}`,label:t[h],disabled:!!i||!!t.disabled,key:`${t[u]}-${a}`}),t[h])),d&&(()=>{if("default"===c){return!b.find(e=>e.id===o)&&e.createElement(m,{value:o},"==",o,"==无对应选项==")}return null})()):e.createElement(q,Object.assign({},f,p))},{Option:I}=h,R=l=>{const{name:n,style:r,value:o,options:s,disabled:i,mode:c="default",show_all:u=!1,value_key:d="id",show_empty:m=!1,label_key:p="name",placeholder:b="请选择"}=l,g=w(l,["name","style","value","options","disabled","mode","show_all","value_key","show_empty","label_key","placeholder"]),[f,y]=t([]);a(()=>{if(Y(s)){const e={[d]:"",[p]:"全部"};y(u?[e,...s]:s)}},[p,s,u,d]);const v={mode:c,value:o,placeholder:b,showSearch:!0,defaultValue:o,disabled:!!i,style:Object.assign({width:"100%"},r),filterOption:(e,t)=>{const{props:a}=t,l=a[p]||"";return!(e=e?e.replace(/(^\s*)|(\s*$)/g,""):null)||-1!==`${l}`.toLowerCase().indexOf(`${e}`.toLowerCase())}};return Y(f)?e.createElement(h,Object.assign({},v,g,{placeholder:b}),f.map((t,a)=>e.createElement(I,Object.assign({},t,{value:`${t[d]}`,label:t[p],disabled:!!i||!!t.disabled,key:`${t[d]}-${a}`}),t[p])),m&&(()=>{if("default"===c){return!f.find(e=>e.id===o)&&e.createElement(I,{value:o},"==",o,"==无对应选项==")}if("multiple"===c){let t=[];return null==o||o.forEach(e=>{!f.find(t=>t[d]===e)&&t.push(e)}),e.createElement(e.Fragment,null,null==t?void 0:t.map(t=>e.createElement(I,{value:t},"==",t,"==无对应选项==")))}return null})()):e.createElement(h,Object.assign({},v,g,{defaultValue:void 0}))},T=(t,a={})=>{if(!t)return null;if(t.is_hide)return null;const l=j(a,null==t?void 0:t.name)||(null==t?void 0:t.defaultValue);return e.createElement(_,Object.assign({id:`form-${(null==t?void 0:t.element_id)||""}-${(null==t?void 0:t.name)||""}`,key:`form-${(null==t?void 0:t.element_id)||""}-${t.name}`,disabled:1===(null==a?void 0:a.disabled)||!0===(null==a?void 0:a.disabled)},t,{value:l}))};var A=".form-search {\n  margin: 12px 20px;\n}\n.mr10 {\n  margin-right: 10px;\n}\n";const B=a=>{const{conditions:n,defaultValues:r,onSearch:i,is_view:c,btnStyle:u,styles:d}=a;if(!Y(n))return console.log("conditions is not array!!"),null;const m=o({defaultValues:r}),{getValues:h,triggerValidation:b}=m,[g,y]=t(!1),v=async()=>{const e=await b(),t=h({nest:!0});console.log("data =>",e,t),i(t)},w=()=>{},E=n.length>3||n.some(e=>e.is_high);return e.createElement(s,Object.assign({},m),e.createElement("section",{className:f(A["form-search"]),style:d},e.createElement(M,{data:n}),E&&e.createElement(p,{type:g?"primary":void 0,icon:g?"up":"down",style:u,className:A.mr10,disabled:c,onClick:()=>y(e=>!e)},"更多"),e.createElement(l,null,e.createElement(p,{type:"primary",className:A.mr10,disabled:c,onClick:v,style:u},"查询"),e.createElement(p,{onClick:w,disabled:c,style:u},"重置"))))};const H=t=>{const{columns:a,rowKey:l,total:n,page:r,loading:o,pageSize:s,onChange:i,dataSource:c}=t,u=w(t,["columns","rowKey","total","page","loading","pageSize","onChange","dataSource"]),d={total:Number(n)||0,current:Number(r)||1,pageSize:Number(s)||10,showQuickJumper:!1,showSizeChanger:!0,pageSizeOptions:["10","20","30","40","50"],showTotal:e=>`共有${e}条`},m={header:{cell:t=>{const a=t||{},{onResize:l,width:n=100}=a,r=w(a,["onResize","width"]);return n?e.createElement(y,{height:0,width:n,onResize:l,draggableOpts:{enableUserSelectHack:!1}},e.createElement("th",Object.assign({},r))):e.createElement("th",Object.assign({},r))}}};return e.createElement("div",{className:".ys-table {\n  width: 100%;\n  overflow: auto;\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n}\n.ys-table :global .ant-table-thead > tr > th {\n  padding: 4px 6px;\n  color: #7ab2ff;\n  font-weight: bold;\n  white-space: nowrap;\n  background: #f0f8ff;\n}\n.ys-table :global .ant-table-tbody > tr > td {\n  cursor: auto;\n  padding: 8px 6px;\n  white-space: nowrap;\n}\n.ys-table .ys-table-text {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n"["ys-table"]},e.createElement(b,Object.assign({bordered:!0},u,{loading:o,columns:a,rowKey:l,onChange:(e,t,a,l)=>{const n=e||{},{showQuickJumper:r,showSizeChanger:o,simple:s,showTotal:c,total:u,current:d}=n,m=w(n,["showQuickJumper","showSizeChanger","simple","showTotal","total","current"]),{pageSize:h}=m||{};i&&i(Object.assign({page:d,per_page:h,page_size:h},m),t,a,l)},components:m,pagination:!!n&&d,dataSource:c})))},J=t=>{const{conditions:a,defaultValues:n,onSearch:r,columns:o,data:s}=t;return e.createElement(l,null,e.createElement(B,{conditions:a,defaultValues:n,onSearch:r}),e.createElement(H,{columns:o,dataSource:s}))};export{J as DataTable,v as Form,x as Utils};
