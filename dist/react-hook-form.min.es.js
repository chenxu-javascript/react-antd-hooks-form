import e,{useState as t,useEffect as a,Fragment as l}from"react";import{useFormContext as n,Controller as r,useForm as o,FormContext as s}from"react-hook-form";import{Checkbox as i,DatePicker as d,Input as c,InputNumber as u,Radio as m,Select as h,Button as p,Table as f}from"antd";import b from"moment";import g from"classnames";import{Resizable as y}from"react-resizable";var _=Object.freeze({__proto__:null,get onRenderHooks(){return R},get BaseForm(){return Y},get CheckBox(){return $},get DatePicker(){return V},get DateTimePicker(){return z},get Form(){return N},get Input(){return T},get InputNumber(){return H},get Radio(){return q},get Select(){return I}});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function v(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(l=Object.getOwnPropertySymbols(e);n<l.length;n++)t.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(a[l[n]]=e[l[n]])}return a}var w=".error {\n  width: auto;\n  min-height: 16px;\n  line-height: 18px;\n  color: #f5222d;\n  word-break: break-all;\n  word-wrap: break-word;\n}\n";const Y=t=>{const{errors:a,control:l}=n(),{rules:o,label:s,value:i,input_type:d,name:c="",className:u="",disabled:m=!1,show_required:h=!0,extend_text:p="",is_required:f=2}=t,b=v(t,["rules","label","value","input_type","name","className","disabled","show_required","extend_text","is_required"]),g=Object.assign(Object.assign({},b),{value:i,defaultValue:i,disabled:m}),y=_[d];return y?e.createElement("div",{className:"hooks-row hooks-form-item",key:c||(new Date).getTime()},!!s&&e.createElement("div",{className:"hooks-col hooks-form-item-label"},e.createElement("label",{htmlFor:c},h&&((null==o?void 0:o.required)||1===f)&&e.createElement("span",{className:w.required},"*"),s)),e.createElement("div",{className:"hooks-col hooks-form-item-wrapper"},e.createElement(r,{as:e.createElement(y,Object.assign({},g)),defaultValue:i,control:l,rules:o,name:c}),e.createElement("div",{className:w.error}," ",a[c]&&a[c].message))):(console.log(`${d} 当前组件不支持`),null)},k=(e,t)=>{if(t())e();else var a=0,l=setInterval((function(){++a>500?clearInterval(l):t()&&(e(),clearInterval(l))}),30)},E=function(e,t){return new Promise((function(a){t?setTimeout((function(){a(e)}),t||1):a(e)}))},O=(e,t)=>{for(var a=/(?:(?:^|\.)([^\.\[\]]+))|(?:\[([^\[\]]+)\])/g,l=[],n=null;null!=(n=a.exec(t));)l.push(n[1]||n[2]);for(var r=e,o=0;o<l.length;o++)if(void 0===(r=null==r?void 0:r[l[o]]))return;return r},j=e=>e&&e instanceof Array&&!!e.length,D=e=>e&&e instanceof Object&&!(e instanceof Array)&&!!Object.keys(e).length;var M=Object.freeze({__proto__:null,isArray:j,isObject:D,bsWait:function(e){return E(null,e)},bsPromise:E,bsCheck:e=>new Promise((function(t){k(t,e)})),bsRunWhen:k,setValueByPath:(e,t,a)=>{for(var l=/(?:(?:^|\.)([^\.\[\]]+))|(?:\[([^\[\]]+)\])/g,n=[],r=null;null!=(r=l.exec(t));)n.push(r[1]||r[2]);if(0===n.length)return e;return function e(t){const l=n[0];t[n[0]]=1===n.length?a:t[n[0]]||{},n.shift(),n.length&&e(t[l])}(e),e},getValueByPath:O});const{Group:x}=i,$=l=>{const{name:n,style:r,value:o,options:s,disabled:d,mode:c="default",show_all:u=!1,value_key:m="id",show_empty:h=!1,label_key:p="name",placeholder:f="请选择"}=l,b=v(l,["name","style","value","options","disabled","mode","show_all","value_key","show_empty","label_key","placeholder"]),[g,y]=t([]);a(()=>{j(s)&&y(s)},[p,s,u,m]);const _={mode:c,value:o,defaultValue:o,disabled:!!d,style:Object.assign({width:"100%"},r)};return j(g)?e.createElement(x,Object.assign({},_,b),g.map((t,a)=>e.createElement(i,Object.assign({},t,{value:`${t[m]}`,label:t[p],disabled:!!d||!!t.disabled,key:`${t[m]}-${a}`}),t[p])),h&&(()=>{if("default"===c){return!g.find(e=>e.id===o)&&e.createElement(i,{value:o},"==",o,"==无对应选项==")}if("multiple"===c){let t=[];return null==o||o.forEach(e=>{!g.find(t=>t[m]===e)&&t.push(e)}),e.createElement(e.Fragment,null,null==t?void 0:t.map(t=>e.createElement(i,{value:t},"==",t,"==无对应选项==")))}return null})()):e.createElement(x,Object.assign({},_,b))};
//! moment.js locale configuration
var S,L;S=void 0,L=function(e){return e.defineLocale("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(e,t){return 12===e&&(e=0),"凌晨"===t||"早上"===t||"上午"===t?e:"下午"===t||"晚上"===t?e+12:e>=11?e:e+12},meridiem:function(e,t,a){var l=100*e+t;return l<600?"凌晨":l<900?"早上":l<1130?"上午":l<1230?"中午":l<1800?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(日|月|周)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",ss:"%d 秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},week:{dow:1,doy:4}})},"object"==typeof exports&&"undefined"!=typeof module&&"function"==typeof require?L(require("../moment")):"function"==typeof define&&define.amd?define(["../moment"],L):L(S.moment);const C={year:"YYYY",month:"YYYY-MM",date:"YYYY-MM-DD",time:"YYYY-MM-DD HH:mm:ss"},V=a=>{const{placeholder:l="请选择",mode:n="date",onChange:r}=a,o=v(a,["placeholder","mode","onChange"]),{value:s,defaultValue:i}=o,[c,u]=t(s||i||void 0),m=e=>{e="month"===n?{start_time:e?`${e.format(C[n]||"YYYY-MM-DD")}-01`:void 0,end_time:e?`${e.format(C[n]||"YYYY-MM-DD")}-${e.daysInMonth()}`:void 0}:e?e.format(C[n]||"YYYY-MM-DD"):void 0,u(e),r&&r(e)},h=c?b(new Date(D(s)?s.start_time:s)):void 0,p=Object.assign(Object.assign({allowClear:!1,placeholder:l,style:{width:"100%"},showTime:"time"===n},o),{value:h,onChange:m,onPanelChange:m,format:C[n]||"YYYY-MM-DD"});return e.createElement(d,Object.assign({},p))},z=t=>e.createElement(V,Object.assign({},t,{mode:"time"})),N=t=>{const{data:a,children:l,defaultValues:n,layout:r="inline",labelAlign:o="right",hideRequiredMark:s=!1}=t,i=`hooks-form hooks-form-${r} label-${o} ${s?"hide_require":""}`;return e.createElement("form",{className:i},l||e.createElement(e.Fragment,null,a.map(e=>R(e,n))))},T=t=>{const{value:a,placeholder:l="请输入",style:n}=t,r=v(t,["value","placeholder","style"]);return e.createElement(c,Object.assign({key:`${t.id}-input`,autoComplete:"off"},r,{defaultValue:a,placeholder:l,style:n}))},H=t=>{const{placeholder:a="请输入"}=t,l=v(t,["placeholder"]);return e.createElement(u,Object.assign({},l,{placeholder:a}))},{Group:P}=m,q=l=>{const{name:n,style:r,value:o,options:s,disabled:i,mode:d="default",value_key:c="id",show_empty:u=!1,label_key:h="name"}=l,p=v(l,["name","style","value","options","disabled","mode","value_key","show_empty","label_key"]),[f,b]=t([]);a(()=>{j(s)&&b(s)},[h,s,c]);const g={mode:d,value:o,defaultValue:o,disabled:!!i,style:Object.assign({width:"100%"},r)};return j(f)?e.createElement(P,Object.assign({},g,p),f.map((t,a)=>e.createElement(m,Object.assign({},t,{value:`${t[c]}`,label:t[h],disabled:!!i||!!t.disabled,key:`${t[c]}-${a}`}),t[h])),u&&(()=>{if("default"===d){return!f.find(e=>e.id===o)&&e.createElement(m,{value:o},"==",o,"==无对应选项==")}return null})()):e.createElement(P,Object.assign({},g,p))},{Option:F}=h,I=l=>{const{name:n,style:r,value:o,options:s,disabled:i,mode:d="default",show_all:c=!1,value_key:u="id",show_empty:m=!1,label_key:p="name",placeholder:f="请选择"}=l,b=v(l,["name","style","value","options","disabled","mode","show_all","value_key","show_empty","label_key","placeholder"]),[g,y]=t([]);a(()=>{if(j(s)){const e={[u]:"",[p]:"全部"};y(c?[e,...s]:s)}},[p,s,c,u]);const _={mode:d,value:o,placeholder:f,showSearch:!0,defaultValue:o,disabled:!!i,style:Object.assign({width:"100%"},r),filterOption:(e,t)=>{const{props:a}=t,l=a[p]||"";return!(e=e?e.replace(/(^\s*)|(\s*$)/g,""):null)||-1!==`${l}`.toLowerCase().indexOf(`${e}`.toLowerCase())}};return j(g)?e.createElement(h,Object.assign({},_,b,{placeholder:f}),g.map((t,a)=>e.createElement(F,Object.assign({},t,{value:`${t[u]}`,label:t[p],disabled:!!i||!!t.disabled,key:`${t[u]}-${a}`}),t[p])),m&&(()=>{if("default"===d){return!g.find(e=>e.id===o)&&e.createElement(F,{value:o},"==",o,"==无对应选项==")}if("multiple"===d){let t=[];return null==o||o.forEach(e=>{!g.find(t=>t[u]===e)&&t.push(e)}),e.createElement(e.Fragment,null,null==t?void 0:t.map(t=>e.createElement(F,{value:t},"==",t,"==无对应选项==")))}return null})()):e.createElement(h,Object.assign({},_,b,{defaultValue:void 0}))},R=(t,a={})=>{if(!t)return null;if(t.is_hide)return null;const l=O(a,null==t?void 0:t.name)||(null==t?void 0:t.defaultValue);return e.createElement(Y,Object.assign({id:`form-${(null==t?void 0:t.element_id)||""}-${(null==t?void 0:t.name)||""}`,key:`form-${(null==t?void 0:t.element_id)||""}-${t.name}`,disabled:1===(null==a?void 0:a.disabled)||!0===(null==a?void 0:a.disabled)},t,{value:l}))};var A=".form-search {\n  margin: 12px 20px;\n}\n.mr10 {\n  margin-right: 10px;\n}\n";const W=a=>{const{conditions:n,defaultValues:r,onSearch:i,is_view:d,btnStyle:c,styles:u}=a;if(!j(n))return console.log("conditions is not array!!"),null;const m=o({defaultValues:r}),{getValues:h,triggerValidation:f}=m,[b,y]=t(!1),_=async()=>{const e=await f(),t=h({nest:!0});console.log("data =>",e,t),i(t)},v=()=>{},w=n.length>3||n.some(e=>e.is_high);return e.createElement(s,Object.assign({},m),e.createElement("section",{className:g(A["form-search"]),style:u},e.createElement(N,{data:n}),w&&e.createElement(p,{type:b?"primary":void 0,icon:b?"up":"down",style:c,className:A.mr10,disabled:d,onClick:()=>y(e=>!e)},"更多"),e.createElement(l,null,e.createElement(p,{type:"primary",className:A.mr10,disabled:d,onClick:_,style:c},"查询"),e.createElement(p,{onClick:v,disabled:d,style:c},"重置"))))};const B=t=>{const{columns:a,rowKey:l,total:n,page:r,loading:o,pageSize:s,onChange:i,dataSource:d}=t,c=v(t,["columns","rowKey","total","page","loading","pageSize","onChange","dataSource"]),u={total:Number(n)||0,current:Number(r)||1,pageSize:Number(s)||10,showQuickJumper:!1,showSizeChanger:!0,pageSizeOptions:["10","20","30","40","50"],showTotal:e=>`共有${e}条`},m={header:{cell:t=>{const a=t||{},{onResize:l,width:n=100}=a,r=v(a,["onResize","width"]);return n?e.createElement(y,{height:0,width:n,onResize:l,draggableOpts:{enableUserSelectHack:!1}},e.createElement("th",Object.assign({},r))):e.createElement("th",Object.assign({},r))}}};return e.createElement("div",{className:".ys-table {\n  width: 100%;\n  overflow: auto;\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n}\n.ys-table :global .ant-table-thead > tr > th {\n  padding: 4px 6px;\n  color: #7ab2ff;\n  font-weight: bold;\n  white-space: nowrap;\n  background: #f0f8ff;\n}\n.ys-table :global .ant-table-tbody > tr > td {\n  cursor: auto;\n  padding: 8px 6px;\n  white-space: nowrap;\n}\n.ys-table .ys-table-text {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n"["ys-table"]},e.createElement(f,Object.assign({bordered:!0},c,{loading:o,columns:a,rowKey:l,onChange:(e,t,a,l)=>{const n=e||{},{showQuickJumper:r,showSizeChanger:o,simple:s,showTotal:d,total:c,current:u}=n,m=v(n,["showQuickJumper","showSizeChanger","simple","showTotal","total","current"]),{pageSize:h}=m||{};i&&i(Object.assign({page:u,per_page:h,page_size:h},m),t,a,l)},components:m,pagination:!!n&&u,dataSource:d})))},J=t=>{const{conditions:a,defaultValues:n,onSearch:r,columns:o,data:s}=t;return e.createElement(l,null,e.createElement(W,{conditions:a,defaultValues:n,onSearch:r}),e.createElement(B,{columns:o,dataSource:s}))};export{J as DataTable,_ as Form,M as Utils};
